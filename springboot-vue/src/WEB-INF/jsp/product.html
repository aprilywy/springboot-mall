<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
<%@page isELIgnored="false"%>
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>  
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script> 
<title>萌芽書屋</title>
<link rel="stylesheet" type="text/css" href="growbook.css">
</head>
<body>
<script type="text/javascript" src="js/bootpag.min.js"></script>
<div id="title">
<div class="container">
	<ul class="nav nav-pills justify-content-end">
		<li class="nav-item">
			<div class="p-2 text-dark" id="account">歡迎光臨</div>
		</li>
		<li class="nav-item">
			<button type="button" class="btn btn-outline-primary btn-sm" href="product">所有商品</button>
		</li>
		<!-- 註冊帳號開始Button to Open the Modal -->
		<li class="nav-item">
        <button type="button" class="btn btn-outline-primary btn-sm" data-toggle="modal" data-target="#myModalReg">會員註冊</button>
  <!-- The Modal -->
  <div class="modal fade" id="myModalReg">
    <div class="modal-dialog">
      <div class="modal-content">
      
        <!-- Modal Header -->
        <div class="modal-header">
          <h1 class="h3 mb-3 font-weight-normal">註冊會員帳號</h1>
          <button type="button" class="close" data-dismiss="modal">&times;</button>
        </div>
        
        <!-- Modal body -->
        <div class="modal-body">
        
             <form class="form-signup"  method="POST" id="regForm" onsubmit="return false;" action="javascript:;">
             <label for="regAccount">請輸入帳號 <!-- <span class="ft-grapefruit ml-3" id="accountChkInfo"></span> --></label>                     
               <label for="userName" class="sr-only">User Name</label>
                <input type="text" id="userName" class="form-control" 
                                  placeholder="User Name" required autofocus><br/>
                <label for="regEmail">請輸入電子信箱</label>
                <label for="Email" class="sr-only">Email</label>
                <input type="email" id="Email" name="Email" class="form-control" 
                             placeholder="Email" required><br/>
                <label for="regPassword">請輸入密碼</label> 
                <label for="Password" class="sr-only">Password</label>
                <input type="password" id="Password" class="form-control" 
                             placeholder="Password" required><br/>
                <label for="regConfirmPassword">請再輸入一次密碼</label>
                <label for="Password" class="sr-only">Confirm Password</label>
                <input type="password" id="ConfirmPassword" class="form-control" 
                             placeholder="ConfirmPassword" required><br/>
                <button type="button" onclick="addAccount();" class="btn btn-primary btn-block">註冊帳號</button>  
          </form>             
        </div>
        
        <!-- Modal footer -->
        <div class="modal-footer">
        
      </div>
    </div>
  </div>
  <p>
    </li>
    <!-- 註冊帳號結束Button to Open the Modal -->
    
    <!-- 登入帳號開始Button to Open the Modal -->
     <li class="nav-item"><!-- Button to Open the Modal -->
        <button type="button" class="btn btn-outline-primary btn-sm" data-toggle="modal" data-target="#myModalMem">會員登入</button>
  <!-- The Modal -->
  <div class="modal fade" id="myModalMem">
    <div class="modal-dialog">
      <div class="modal-content">
      
        <!-- Modal Header -->
        <div class="modal-header">
          <h1 class="h3 mb-3 font-weight-normal">登入會員帳號</h1>
          <button type="button" class="close" data-dismiss="modal">&times;</button>
        </div>
        
        <!-- Modal body -->
        <div class="modal-body">
             <form class="form-signin" onsubmit="return false;">                     
               <label for="userName" class="sr-only">User Name</label>
                <input type="text" id="userName" class="form-control" 
                                  placeholder="User Name" required autofocus><br/>
                <label for="Password" class="sr-only">Password</label>
                <input type="password" id="Password" class="form-control" 
                             placeholder="Password" required><br/>
               <div class="checkbox">
                   <label>
                       <input type="checkbox" value="remember-me"> 記住我的登入
                  </label>
               </div>
               <button class="btn  btn-primary btn-block" type="button" onClick="check();">登入</button>  
          </form>             
        </div>
        
        <!-- Modal footer -->
        <div class="modal-footer">
        
      </div>
    </div>
  </div>
  <p>
    </li>
    <!-- 登入帳號結束Button to Open the Modal -->
  </ul>
</div>
</div>
<!-- 商品圖片框架開始 -->
<div class="row" id="content" >
          <div class="col-md-4" align="center"> 
          
  				<div class="card" style="width:360px;margin-left: 20px;" >
			    <img class="card-img-top" src=""  id="img1"  alt="Product Image 1" style="width:90%"  align="center">
			    <div class="card-body">
			      <h4 class="card-title" id="t1"></h4>
			      <p class="card-text" id="d1"></p>NT$
			      <p class="card-text" id="p1"></p>	
			      <a href="" id="h1" class="btn btn-primary">放入購物車</a>
    			</div>
  				</div>
  				
  			</div>
  	 
  		<div class="col-md-4" align="center">   
			  <div class="card" style="width:360px;margin-left: 5px; margin-right:5px">
			    <img class="card-img-top" src="" id="img2"  alt="Product Image 2" style="width:90%"  align="center">
			    <div class="card-body">
			      <h4 class="card-title" id="t2"></h4>
			      <p class="card-text" id="d2"></p>NT$
			      <p class="card-text" id="p2"></p>
			      
			      <a href="" id="h2" class="btn btn-primary">放入購物車</a>
    			
    			</div>
  			</div>
  		</div>

		  <div class="col-md-4" align="center">      
		  <div class="card" style="width:360px; margin-right:20px">
		    <img class="card-img-top" src="" id="img3"  alt="Product Image 3" style="width:90%"  align="center">
		    <div class="card-body">
		      <h4 class="card-title" id="t3"></h4>
		      <p class="card-text" id="d3"></p>NT$
		      <p class="card-text" id="p3"></p>
		      
		      <a href="" id="h3" class="btn btn-primary">放入購物車</a>
		    
		    </div>
		  </div>
		  </div>
 
</div>
<!-- 商品圖片框架結束 -->

<script  type="text/javascript">

	/* 會員帳號登入檢查開始 */
  	function check(){
	  $.ajax({
        url: "check", 
        data:{"userName":$("#userName").val(),"password":$("#password").val()},                        
        cache:false ,
        type: "GET",
        dataType: 'text',
        success: function (msg) {              	
               alert(msg);
               window.location.reload();
               $('#myModalMem').modal('hide');
        },
        error: function (xhr, ajaxOptions, thrownError) {
            alert(xhr.status);
            alert(thrownError);
        }
    });
    return false;
}  
	/* 會員帳號登入檢查結束 */
	
	/* 會員帳號登入顯示開始 */
/* 	var account = $("input[name='userName']").val(); */
	/* 會員帳號登入顯示結束 */
	
	/* 會員帳號註冊檢查開始 */
  	  function addAccount(){
		  $.ajax({
	        url: "addAccount", 
	        data:{"userName":$("#userName").val(),"email":$("#email").val(),"password":$("#password").val(),"confirmPassword":$("#confirmPassword").val()},                        
	        cache:false ,
	        type: "GET",
	        dataType: 'text',
	        success: function (msg) {              	
	               alert(msg);
	               $('#myModalReg').modal('hide');
	               window.location.reload(); 
	               
	                /* var result = data.trim();
				
				if(result == "true"){
					//alert("此帳號已被申請");
					$('#accountChkInfo').text("此帳號已被申請");
				}else if(result == "false"){
					//alert("此帳號可以申請註冊");
					$('#accountChkInfo').text("此帳號可以申請註冊");
				}else{
					$('#accountChkInfo').text("請稍後再重試");
				}
			},complete : function () {
				//location.reload();
			}, beforeSend:function(){
				$('#accountChkInfo').text("");
				var emailRegxp = /^([\w-\.]+)@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.)|(([\w-]+\.)+))([a-zA-Z]{2,4}|[0-9]{1,3})(\]?)$/;
				var accountRegExp = /^[\d|a-zA-Z]+$/;

				if (!$("input[name='regAccount']").val()) {
					alert('請填寫帳號!');
					return false;
				}		
					
				if (accountRegExp.test($("input[name='regAccount']").val()) == false){
					alert('帳號只能為數字加英文的組合!');
					return false;
				}
					
				if ($("input[name='regAccount']").val().length > 50) {
					alert('帳號請填入50個字元內，小寫或大寫英文字母(a~z，A~Z)、數字(0~9)');
					return false;
				}
					
				if (!$("input[name='regEmail']").val()) {
					alert('請填寫email!');
					return false;
				}		
					
				if (!$("input[name='regPassword']").val()) {
					alert('請輸入密碼!');
					return false;
				}
					
				if (!$("input[name='regConfirmPassword']").val()) {
					alert('請再次確認密碼!');
					return false;
				}
						
				if($("input[name='regPassword']").val() != $("input[name='regConfirmPassword']").val()){
					alert('兩次輸入的密碼不相同，請重新確認!');
					return false;
				} 
					
 				$('#regForm').submit();
			} 
	        },
	        error: function (xhr, ajaxOptions, thrownError) {
	            alert(xhr.status);
	            alert(thrownError);
	        }
	    });
	    return false;
	    } */  
	/* 會員帳號註冊檢查結束 */

	
	/* 商品框架開始 */
 	function show(arry){   
        var picPage=0;
        if(arry.length%3==0)
            picPage=   arry.length/3;
        else
     	   picPage=   arry.length/3+1;     
        $('#page-selection').bootpag({
     	      maxVisible: 5,
     	      total: picPage
     	  }).on("page", function(event,  pgnum){
     	       display(arry , pgnum);
     	  });
        display(arry,1);
}
	/* 商品框架結束 */

	/* 商品內容及圖片開始 */
	function display(arry,num){
        
        var index= (num-1)*3
		$("#img1").attr("src", arry[index].photo);
        $("#t1").text(arry[index].productName);
        $("#d1").text(arry[index].description);
        $("#p1").text(arry[index].price);
        $("#h1").attr("href", "cart/buy/"+arry[index].id);
        $("#img2").attr("src", arry[index+1].photo);
        $("#t2").text(arry[index+1].productName);
        $("#d2").text(arry[index+1].description);
        $("#p2").text(arry[index+1].price);
        $("#h2").attr("href", "cart/buy/"+arry[index+1].id);
        $("#img3").attr("src", arry[index+2].photo);
        $("#t3").text(arry[index+2].productName);
        $("#d3").text(arry[index+2].description);
        $("#p3").text(arry[index+2].price);
        $("#h3").attr("href", "cart/buy/"+arry[index+2].id);
     }
      function start(){
    	  $.ajax({
              url: "hbpicture",                         
              cache:false ,
              type: "GET",
              dataType: 'json',
              success: function (objArry) {      	
                     show(objArry);
              },
              error: function (xhr, ajaxOptions, thrownError) {
                  alert(xhr.status);
                  alert(thrownError);
              }
          });
      }
      $(document).ready(start);
  	/* 商品內容及圖片結束 */
</script>
<p></p>

<div id="end">
<p></p>
<p></p>
    <div id="page-selection">頁次</div> 
 </div>
</body>
</html>